<!DOCTYPE html><html lang="en"><head><title>src\games\Choose2Win</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../"><meta name="groc-document-path" content="src\games\Choose2Win"><meta name="groc-project-path" content="src\games\Choose2Win.js"><link rel="stylesheet" type="text/css" media="all" href="../../assets/style.css"><script type="text/javascript" src="../../assets/behavior.js"></script><body><div id="meta"><div class="file-path">src\games\Choose2Win.js</div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><p>Simple silly game where players can instantly choose to win, loose, draw or
    just continue. Mostly for testing purposes.</p></div></div><div class="code"><div class="wrapper"><span class="nx">games</span><span class="p">.</span><span class="nx">Choose2Win</span> <span class="o">=</span> <span class="nx">declare</span><span class="p">(</span><span class="nx">Game</span><span class="p">,</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>new games.Choose2Win(turns=Infinity, activePlayer=players[0], winner=none):
    Choose2Win is a silly game indeed. Each turn one of the players can
    decide to win, to lose or to pass the turn. It is meant to be used 
    only for testing Ludorum, since a game can hardly become less 
    interesting than this.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">constructor</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">Choose2Win</span><span class="p">(</span><span class="nx">turns</span><span class="p">,</span> <span class="nx">activePlayer</span><span class="p">,</span> <span class="nx">winner</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Game</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">activePlayer</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">__turns__</span> <span class="o">=</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">turns</span><span class="p">)</span> <span class="o">?</span> <span class="kc">Infinity</span> <span class="o">:</span> <span class="o">+</span><span class="nx">turns</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">__winner__</span> <span class="o">=</span> <span class="nx">winner</span><span class="p">;</span>   
  <span class="p">},</span>

  <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Choose2Win&#39;</span><span class="p">,</span>
  </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>games.Choose2Win.players=['This', 'That']:
    Players of the dummy game.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">players</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;This&#39;</span><span class="p">,</span> <span class="s1">&#39;That&#39;</span><span class="p">],</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>games.Choose2Win.moves():
    Moves always are 'win', 'lose', 'pass'.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">moves</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">moves</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">__winner__</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">__turns__</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">obj</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">activePlayer</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;win&#39;</span><span class="p">,</span> <span class="s1">&#39;lose&#39;</span><span class="p">,</span> <span class="s1">&#39;pass&#39;</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>games.Choose2Win.result():
    Victory for who chooses to win. Defeat for who chooses to lose. Draw 
    only when a limit of turns (if given) is met.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">result</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">result</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">__winner__</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">victory</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">__winner__</span><span class="p">)</span> <span class="o">:</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">__turns__</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">draw</span><span class="p">()</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>games.Choose2Win.next(moves):
    Moves must be always 'win', 'lose' or 'pass'.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">next</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">next</span><span class="p">(</span><span class="nx">moves</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">activePlayer</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">activePlayer</span><span class="p">(),</span>
      <span class="nx">opponent</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">opponent</span><span class="p">(</span><span class="nx">activePlayer</span><span class="p">);</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">moves</span><span class="p">[</span><span class="nx">activePlayer</span><span class="p">])</span> <span class="p">{</span>
      <span class="k">case</span> <span class="s1">&#39;win&#39;</span><span class="o">:</span> <span class="k">return</span> <span class="k">new</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">__turns__</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">opponent</span><span class="p">,</span> <span class="nx">activePlayer</span><span class="p">);</span>
      <span class="k">case</span> <span class="s1">&#39;lose&#39;</span><span class="o">:</span> <span class="k">return</span> <span class="k">new</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">__turns__</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">opponent</span><span class="p">,</span> <span class="nx">opponent</span><span class="p">);</span>
      <span class="k">case</span> <span class="s1">&#39;pass&#39;</span><span class="o">:</span> <span class="k">return</span> <span class="k">new</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">__turns__</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">opponent</span><span class="p">);</span>
      <span class="k">default</span><span class="o">:</span> <span class="k">break</span><span class="p">;</span> <span class="c1">// So the lint would not complaint.</span>
    <span class="p">}</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Invalid move &#39;</span><span class="o">+</span> <span class="nx">moves</span><span class="p">[</span><span class="nx">activePlayer</span><span class="p">]</span> <span class="o">+</span><span class="s1">&#39; for player &#39;</span><span class="o">+</span> <span class="nx">activePlayer</span> <span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="p">);</span>
  <span class="p">},</span>
  
  <span class="nx">__serialize__</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">__serialize__</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">__turns__</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">activePlayer</span><span class="p">(),</span> <span class="k">this</span><span class="p">.</span><span class="nx">__winner__</span><span class="p">];</span>
  <span class="p">}</span>
<span class="p">});</span> <span class="c1">// declare Choose2Win.</span></div></div></div></div></body></html>